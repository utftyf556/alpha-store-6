<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù…ØªØ¬Ø±ÙŠ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</title>
<style>
:root{
  --mainBtnColor:#ff9800;      /* Ù„ÙˆÙ† Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø´Ø±ÙŠØ· */
  --sidebarColor:#00bcd4;      /* Ù„ÙˆÙ† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
}
body{margin:0;font-family:Arial;background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);color:white;}
header{text-align:center;padding:15px;font-size:26px;background:#000;position:sticky;top:0;z-index:100;}
#mainBar{display:flex;justify-content:center;gap:10px;margin:10px 0;flex-wrap:wrap;}
#mainBar button{padding:8px 15px;border:none;border-radius:5px;cursor:pointer;font-weight:bold;background:var(--mainBtnColor);color:white;}
#searchBar{width:90%;max-width:400px;display:block;margin:5px auto 15px auto;padding:8px;border-radius:6px;border:none;}
.products{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:20px;padding:10px;}
.card{background:#ffffff10;backdrop-filter:blur(10px);padding:10px;border-radius:12px;text-align:center;}
.card img{width:100%;height:180px;object-fit:cover;border-radius:8px;}
button.mainBtn{background:#00c6ff;border:none;padding:8px;margin-top:5px;width:100%;border-radius:6px;cursor:pointer;color:white;font-weight:bold;}
#visitors{text-align:center;margin:10px 0;font-size:18px;}
#reviews{padding:10px;background:#0005;margin:10px;border-radius:10px;}
.review{background:#ffffff10;padding:8px;margin:5px 0;border-radius:6px;display:flex;align-items:center;gap:10px;}
.stars span{color:gold;font-size:18px;}
.admin{display:none;position:fixed;top:0;left:0;width:350px;height:100%;background:#000;padding:15px;overflow:auto;z-index:999;}
input, select, textarea{width:100%;padding:6px;margin:5px 0;border-radius:5px;border:none;}
.closeBtn{background:red;margin-top:10px;}
#adminBtn{position:fixed;top:10px;left:10px;background:var(--mainBtnColor);padding:10px;border-radius:5px;font-weight:bold;cursor:pointer;z-index:1000;}
#liveOrdersNotice{position:fixed;bottom:20px;right:20px;background:orange;padding:10px;border-radius:8px;font-weight:bold;z-index:9999;display:none;}
#customerNotice{position:fixed;bottom:20px;left:20px;background:#ff9800;padding:15px 20px;border-radius:10px;color:white;font-weight:bold;cursor:pointer;display:none;z-index:9999;box-shadow:0 4px 10px rgba(0,0,0,0.3);}
#hamburger{position:fixed;top:10px;right:10px;font-size:30px;cursor:pointer;z-index:1000;color:var(--mainBtnColor);}
#sidebar{position:fixed;top:0;right:-300px;width:250px;height:100%;background:var(--sidebarColor);padding:20px;box-shadow:-3px 0 10px #000a;transition:right 0.3s;z-index:999;}
#sidebar.show{right:0;}
#sidebar button{margin-top:20px;padding:8px;width:100%;border:none;border-radius:5px;background:var(--mainBtnColor);color:white;cursor:pointer;}
.categorySidebarBox{padding:10px;margin:5px 0;background:var(--mainBtnColor);color:white;border-radius:5px;cursor:pointer;text-align:center;}
</style>
</head>
<body>

<header id="storeName">Ù…ØªØ¬Ø±ÙŠ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</header>

<!-- Ø²Ø± Ø§Ù„Ù‡Ø§Ù…Ø¨Ø±ØºØ± -->
<div id="hamburger" onclick="toggleSidebar()">â˜°</div>

<!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© -->
<div id="sidebar">
  <h3>Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</h3>
  <div id="sidebarCategories"></div>
  <button onclick="toggleSidebar()">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<div id="mainBar">
<button onclick="render()">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
<button onclick="document.getElementById('searchBar').focus()">Ø¨Ø­Ø«</button>
</div>

<input type="text" id="searchBar" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª..." oninput="searchProducts()">

<div id="visitors">Ø§Ù„Ø²ÙˆØ§Ø± Ø§Ù„Ø­Ø§Ù„ÙŠÙŠÙ†: 0</div>

<div class="products" id="products"></div>

<div id="reviews">
<h3>Ø¢Ø±Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h3>
<div id="reviewList"></div>
<input id="reviewName" placeholder="Ø§Ø³Ù…Ùƒ">
<select id="reviewGender">
<option value="male">Ø°ÙƒØ±</option>
<option value="female">Ø£Ù†Ø«Ù‰</option>
</select>
<label>Ø§Ù„ØªÙ‚ÙŠÙŠÙ…:
<select id="reviewStars">
<option value="1">1 â­</option>
<option value="2">2 â­â­</option>
<option value="3">3 â­â­â­</option>
<option value="4">4 â­â­â­â­</option>
<option value="5" selected>5 â­â­â­â­â­</option>
</select>
</label>
<textarea id="newReview" placeholder="Ø§ÙƒØªØ¨ Ø±Ø£ÙŠÙƒ Ù‡Ù†Ø§..."></textarea>
<button onclick="addReview()">Ø¥Ø¶Ø§ÙØ© Ø±Ø£ÙŠ</button>
</div>

<div id="adminBtn" onclick="adminLogin()">Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø§Ù„Ùƒ</div>

<div class="admin" id="adminPanel">
<h3>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø§Ù„Ùƒ</h3>

<h4>Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ù…ØªØ¬Ø±</h4>
<label>Ù„ÙˆÙ† Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ:</label>
<input type="color" id="mainBtnColorInput" value="#ff9800" onchange="changeMainBtnColor(this.value)">
<label>Ù„ÙˆÙ† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ©:</label>
<input type="color" id="sidebarColorInput" value="#00bcd4" onchange="changeSidebarColor(this.value)">
<hr>

<h4>Ø§Ù„Ø£Ù‚Ø³Ø§Ù…</h4>
<input id="newCategoryName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯">
<button onclick="addCategory()">Ø¥Ø¶Ø§ÙØ© Ù‚Ø³Ù…</button>
<select id="deleteCategorySelect"></select>
<button onclick="deleteCategory()">Ø­Ø°Ù Ø§Ù„Ù‚Ø³Ù…</button>
<hr>

<h4>Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬</h4>
<select id="productCategorySelect"></select>
<input id="pName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬">
<input id="pPrice" placeholder="Ø§Ù„Ø³Ø¹Ø±">
<textarea id="pDesc" placeholder="Ø§Ù„ÙˆØµÙ"></textarea>
<input type="file" id="pImageFile" accept="image/*">
<input type="number" id="pSold" placeholder="Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ù…Ø¨Ø§Ø¹Ø©">
<button onclick="addProduct()">Ø¥Ø¶Ø§ÙØ©</button>
<hr>

<h4>Ø­Ø°Ù Ù…Ù†ØªØ¬</h4>
<select id="deleteProductSelect"></select>
<button onclick="deleteProduct()">Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬</button>
<hr>

<h4>ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…</h4>
<input id="couponCodeInput" placeholder="Ø§Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯">
<input type="number" id="couponValueInput" placeholder="Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ… Ø¨Ø§Ù„Ø±ÙŠØ§Ù„">
<button onclick="saveCoupon()">Ø­ÙØ¸ Ø§Ù„ÙƒÙˆØ¯</button>
<hr>

<h4>Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡</h4>
<input id="newNoticeText" placeholder="Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±">
<button onclick="addNotice()">Ø¥Ø¶Ø§ÙØ© Ø¥Ø´Ø¹Ø§Ø±</button>
<select id="deleteNoticeSelect"></select>
<button onclick="deleteNotice()">Ø­Ø°Ù Ø¥Ø´Ø¹Ø§Ø±</button>

<hr>
<button class="closeBtn" onclick="closeAdmin()">Ø¥ØºÙ„Ø§Ù‚</button>
</div>

<div id="liveOrdersNotice"></div>
<div id="customerNotice"></div>

<script>
// ==================== Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ====================
let password = "112211";
let categories = JSON.parse(localStorage.getItem("categories")) || [];
let products = JSON.parse(localStorage.getItem("products")) || [];
let reviews = JSON.parse(localStorage.getItem("reviews")) || [];
let coupon = JSON.parse(localStorage.getItem("coupon")) || {code:"",value:0};
let visitorsCount = Math.floor(Math.random()*10 + 5);
let notices = JSON.parse(localStorage.getItem("notices")) || [];
let liveOrdersCount = 0;

// ==================== Live Ø§Ù„Ø²ÙˆØ§Ø± ====================
function updateVisitors(){
visitorsCount += Math.floor(Math.random()*3 -1);
if(visitorsCount<1) visitorsCount=1;
document.getElementById("visitors").innerText="Ø§Ù„Ø²ÙˆØ§Ø± Ø§Ù„Ø­Ø§Ù„ÙŠÙŠÙ†: "+visitorsCount;
}
setInterval(updateVisitors,60000);

// ==================== Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ====================
function addCategory(){
let name=document.getElementById("newCategoryName").value.trim();
if(name && !categories.includes(name)){
categories.push(name); saveData(); document.getElementById("newCategoryName").value=""; render(); renderSidebarCategories();
}else{alert("Ø§Ù„Ù‚Ø³Ù… Ù…ÙˆØ¬ÙˆØ¯ Ø£Ùˆ ÙØ§Ø±Øº!");}
}
function deleteCategory(){
let select = document.getElementById("deleteCategorySelect");
let category = select.value;
if(category){ categories = categories.filter(c=>c!==category); products = products.filter(p=>p.category!==category); saveData(); render(); renderSidebarCategories();}
}
function updateCategorySelects(){
let prodSelect=document.getElementById("productCategorySelect");
let delCatSelect=document.getElementById("deleteCategorySelect");
prodSelect.innerHTML=""; delCatSelect.innerHTML="";
categories.forEach(c=>{
let opt1=document.createElement("option"); opt1.value=c; opt1.text=c; prodSelect.appendChild(opt1);
let opt2=document.createElement("option"); opt2.text=c; opt2.value=c; delCatSelect.appendChild(opt2);
});
}
function renderSidebarCategories(){
let container = document.getElementById("sidebarCategories");
container.innerHTML="";
categories.forEach(c=>{
let div = document.createElement("div");
div.className="categorySidebarBox"; div.innerText=c;
div.onclick = ()=>{render(products.filter(p=>p.category===c)); toggleSidebar();}
container.appendChild(div);
});
}
function toggleSidebar(){
document.getElementById("sidebar").classList.toggle("show");
}

// ==================== Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª ====================
function render(displayProducts=null){
let container=document.getElementById("products"); container.innerHTML="";
let list = displayProducts||products;
list.forEach((p,i)=>{
container.innerHTML+=`
<div class="card">
<img src="${p.image}">
<h3>${p.name}</h3>
<p>${p.price} Ø±ÙŠØ§Ù„</p>
<p>${p.description||""}</p>
<p>Ù‚Ø³Ù…: ${p.category}</p>
<p>ØªÙ… Ø´Ø±Ø§Ø¤Ù‡: ${p.sold||0}</p>
<input type="text" placeholder="ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…" id="couponInput${i}">
<button class="mainBtn" onclick="order(${i})">Ø·Ù„Ø¨ Ø¹Ø¨Ø± ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…</button>
</div>
`;
});
updateCategorySelects();
updateDeleteProductSelect();
renderReviews();
updateNoticeSelect();
}

// Ø§Ù„Ø¨Ø­Ø«
function searchProducts(){
let query=document.getElementById("searchBar").value.toLowerCase();
let filtered = products.filter(p=>p.name.toLowerCase().includes(query));
render(filtered);
}

// Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ (ÙŠÙ†Ø´Ø± Ù…Ø¨Ø§Ø´Ø±Ø©)
function addProduct(){
let name=document.getElementById("pName").value.trim();
let price=document.getElementById("pPrice").value.trim();
let desc=document.getElementById("pDesc").value.trim();
let file=document.getElementById("pImageFile").files[0];
let category=document.getElementById("productCategorySelect").value;
let sold = parseInt(document.getElementById("pSold").value)||0;
if(!name || !price || !file || !category){alert("Ø§Ù…Ù„Ø£ ÙƒÙ„ Ø§Ù„Ø­Ù‚ÙˆÙ„"); return;}
let reader = new FileReader();
reader.onload=function(e){
products.push({name,price,image:e.target.result,category,description:desc,sold});
saveData(); render(); document.getElementById("pName").value=""; document.getElementById("pPrice").value=""; document.getElementById("pDesc").value=""; document.getElementById("pImageFile").value=""; document.getElementById("pSold").value="";
};
reader.readAsDataURL(file);
}

// Ø­Ø°Ù Ù…Ù†ØªØ¬
function updateDeleteProductSelect(){
let select = document.getElementById("deleteProductSelect"); select.innerHTML="";
products.forEach((p,i)=>{
let opt=document.createElement("option"); opt.value=i; opt.text=`${p.name} (${p.category})`; select.appendChild(opt);
});
}
function deleteProduct(){
let index = document.getElementById("deleteProductSelect").value;
if(index!==null){products.splice(index,1); saveData(); render();}
}

// ==================== Ø§Ù„Ø·Ù„Ø¨Ø§Øª ====================
function order(i){
    let p = products[i];
    let inputCode = document.getElementById(`couponInput${i}`).value.trim();
    let finalPrice = parseFloat(p.price);
    if(inputCode && inputCode===coupon.code){ 
        finalPrice = Math.max(0, finalPrice - coupon.value); 
    }

    p.sold = (p.sold||0)+1; 
    saveData(); 
    render();

    let orderMsg = `ğŸ›’ Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯\nØ§Ù„Ù…Ù†ØªØ¬: ${p.name}\nØ§Ù„Ø³Ø¹Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${finalPrice} Ø±ÙŠØ§Ù„\nØ§Ù„Ù‚Ø³Ù…: ${p.category}`;
    if(inputCode===coupon.code){ orderMsg += `\nØªÙ… ØªØ·Ø¨ÙŠÙ‚ ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ…: ${coupon.code}`; }

    if(confirm(`Ù‡Ø°Ø§ Ù‡Ùˆ Ù†Øµ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ:\n\n${orderMsg}\n\nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ø±Ø³Ø§Ù„Ù‡ Ø¹Ù„Ù‰ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù…ØŸ`)){
        window.location.href = "https://t.me/aa5c_q?text=" + encodeURIComponent(orderMsg);
    }

    liveOrdersCount++; showLiveOrderNotice();
    setTimeout(()=>{liveOrdersCount--; renderLiveOrdersNotice();},5000);
}

function showLiveOrderNotice(){
let notice = document.getElementById("liveOrdersNotice");
notice.style.display="block"; notice.innerText=`Ù‡Ù†Ø§Ùƒ ${liveOrdersCount} Ø´Ø®Øµ ÙŠØ·Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø¢Ù†`;
}
function renderLiveOrdersNotice(){
let notice = document.getElementById("liveOrdersNotice");
if(liveOrdersCount>0){notice.innerText=`Ù‡Ù†Ø§Ùƒ ${liveOrdersCount} Ø´Ø®Øµ ÙŠØ·Ù„Ø¨ Ø§Ù„Ù…Ù†ØªØ¬ Ø§Ù„Ø¢Ù†`;}
else notice.style.display="none";
}

// ==================== Ø¢Ø±Ø§Ø¡ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ====================
function renderReviews(){
let container = document.getElementById("reviewList"); container.innerHTML="";
reviews.forEach(r=>{
let avatar = r.gender==="male"?"ğŸ‘¦":"ğŸ‘§";
let starsHTML = '';
for(let i=0;i<5;i++){starsHTML += `<span>${i<r.stars?'â­':''}</span>`;}
container.innerHTML+=`<div class="review"><span class="avatar">${avatar}</span><b>${r.name}:</b> ${r.text}<div class="stars">${starsHTML}</div></div>`;
});
}
function addReview(){
let name = document.getElementById("reviewName").value.trim();
let gender = document.getElementById("reviewGender").value;
let stars = parseInt(document.getElementById("reviewStars").value);
let text = document.getElementById("newReview").value.trim();
if(!name || !text){alert("Ø§ÙƒØªØ¨ Ø§Ø³Ù…Ùƒ ÙˆÙ†Øµ Ø§Ù„ØªØ¹Ù„ÙŠÙ‚"); return;}
reviews.push({name,gender,text,stars}); saveData();
document.getElementById("reviewName").value=""; document.getElementById("newReview").value=""; renderReviews();
}

// ==================== Ù„ÙˆØ­Ø© Ø§Ù„Ù…Ø§Ù„Ùƒ ====================
function closeAdmin(){document.getElementById("adminPanel").style.display="none";}
function adminLogin(){
let pass = prompt("Ø§Ø¯Ø®Ù„ ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø§Ù„Ù…Ø§Ù„Ùƒ");
if(pass===password){document.getElementById("adminPanel").style.display="block";}
else{alert("ÙƒÙ„Ù…Ø© Ù…Ø±ÙˆØ± Ø®Ø§Ø·Ø¦Ø©");}
}
function changeMainBtnColor(color){document.documentElement.style.setProperty('--mainBtnColor',color);}
function changeSidebarColor(color){document.documentElement.style.setProperty('--sidebarColor',color);}

// ==================== ÙƒÙˆØ¯ Ø§Ù„Ø®ØµÙ… ====================
function saveCoupon(){
let code = document.getElementById("couponCodeInput").value.trim();
let value = parseFloat(document.getElementById("couponValueInput").value)||0;
coupon = {code,value}; saveData(); alert(`ØªÙ… Ø­ÙØ¸ Ø§Ù„ÙƒÙˆØ¯: ${code} Ø¨Ù‚ÙŠÙ…Ø© Ø®ØµÙ… ${value} Ø±ÙŠØ§Ù„`);
}

// ==================== Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ====================
function addNotice(){
let text = document.getElementById("newNoticeText").value.trim();
if(!text) return alert("Ø§ÙƒØªØ¨ Ù†Øµ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±");
notices.push(text); saveData(); document.getElementById("newNoticeText").value=""; updateNoticeSelect();
}
function deleteNotice(){
let index = document.getElementById("deleteNoticeSelect").value;
if(index!==null){ notices.splice(index,1); saveData(); updateNoticeSelect();}
}
function updateNoticeSelect(){
let select = document.getElementById("deleteNoticeSelect"); select.innerHTML="";
notices.forEach((n,i)=>{ let opt=document.createElement("option"); opt.value=i; opt.text=n; select.appendChild(opt);});
}

function showCustomerNotice(message, duration=5000){
    let notice = document.getElementById("customerNotice");
    notice.innerText = message; notice.style.display = "block";
    setTimeout(()=>{ notice.style.display="none"; }, duration);
    notice.onclick = ()=>{ alert("Ø´ÙƒØ±Ø§Ù‹ Ù„ØªÙØ§Ø¹Ù„Ùƒ!"); notice.style.display="none"; };
}
function displayOwnerNotices(){
    if(notices.length===0) return;
    let msg = notices[Math.floor(Math.random()*notices.length)];
    showCustomerNotice(msg,8000);
}
setInterval(displayOwnerNotices, Math.floor(Math.random()*20000+20000));

// ==================== Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ====================
function saveData(){
localStorage.setItem("categories",JSON.stringify(categories));
localStorage.setItem("products",JSON.stringify(products));
localStorage.setItem("reviews",JSON.stringify(reviews));
localStorage.setItem("coupon",JSON.stringify(coupon));
localStorage.setItem("notices",JSON.stringify(notices));
}

// ==================== ØªØ´ØºÙŠÙ„ Ø£ÙˆÙ„ Ù…Ø±Ø© ====================
render();
renderSidebarCategories();
</script>
</body>
</html>
